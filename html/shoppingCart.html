<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>中介者模式</title>
</head>

<body>
  <div class="container">
    选择颜色:
    <select id="colorSelect">
        <option value="">请选择</option>
        <option value="red">红色</option>
        <option value="blue">蓝色</option>
    </select>
    <br/>
    <br/>
    选择内存：
    <select id="memorySelect">
        <option value="">请选择</option>
        <option value="32G">32G</option>
        <option value="64G">64G</option>
    </select>
    <p>输入购买的数量: <input type="text" id="numberInput"/></p>
    你选择了的颜色：<span id="colorInfo"></span><br>
    你选择了内存：<span id="memoryInfo"></span>
    <p>你输入的数量: <span id="numberInfo"></span> </p>
    <button id="nextBtn" disabled="true">请选择手机颜色和购买数量</button>
  </div>
</body>
<script type="text/javascript">
  var goods={
    'red|32G':6,
    'red|64G':16,
    'blue|32G':8,
    'blue|64G':18
  };
  var colorSelect = document.getElementById("colorSelect"),
    memorySelect = document.getElementById("memorySelect"),
    numberInput = document.getElementById("numberInput"),
    colorInfo = document.getElementById("colorInfo"),
    numberInfo = document.getElementById("numberInfo"),
    memoryInfo = document.getElementById("memoryInfo"),
    nextBtn = document.getElementById("nextBtn"),
    colorSelect = document.getElementById("colorSelect"),
    memorySelect = document.getElementById("memorySelect"),
    numberInput = document.getElementById("numberInput"),
    colorInfo = document.getElementById("colorInfo"),
    numberInfo = document.getElementById("numberInfo"),
    memoryInfo = document.getElementById("memoryInfo"),
    nextBtn = document.getElementById("nextBtn");

  colorSelect.onchange=function(){
    select()
  }
  numberInput.oninput=function(){
    select()
  } 
  memorySelect.onchange=function(){
    select()
  }

  function select(){
    var color=colorSelect.value,
      number=numberInput.value,
      memory=memorySelect.value,
      stock=goods[color+'|'+memory];

      colorInfo.innerHTML=color;
      numberInfo.innerHTML=number;
      memoryInfo.innerHTML=memory;
      if(!color){
        nextBtn.disabled=true;
        nextBtn.innerHTML='请选择手机颜色';
        return;
      }
      if(!memory){
        nextBtn.disabled=true;
        nextBtn.innerHTML='请选择手机内存';
        return;
      }
      var reg=/^\d+$/g;
      if(!reg.test(number)){
        nextBtn.disabled=true;
        nextBtn.innerHTML='请输入正确的购买数量';
        return;
      }
      if(number>stock){
        nextBtn.disabled=true;
        nextBtn.innerHTML='库存不足';
        return;
      }
      nextBtn.disabled=false;
      nextBtn.innerHTML='加入购物车';
  }

</script>
</html>